"0","data |>"
"0","  select(patient_nbr,gender) |>"
"0","  group_by(patient_nbr) |>"
"0","  mutate(number_of_visits = n()) |>"
"0","  distinct(patient_nbr,.keep_all = TRUE) |>"
"0","  ungroup() |>"
"0","  select(gender, number_of_visits) |>"
"0","  group_by(number_of_visits,gender) |>"
"0","  summarise(count = n(), .groups = 'drop') |>"
"0","  ggplot(aes(x = number_of_visits, y = gender)) + "
"0","  geom_count(aes(color = gender, "
"0","                 size = count,  "
"0","                 shape = factor(count)),"
"0","      position = position_jitter(height = 0.2)) +"
"0","  labs(x = ""Number of visits"","
"0","       y = ""Gender"","
"0","       title = ""Number of visits by gender"") +"
"0","  scale_color_manual(values = c(""hotpink"", ""cornflowerblue"", ""grey35"")) +"
"0","  scale_size_continuous("
"0","    range = c(2, 10), "
"0","    trans = 'sqrt',  "
"0","    breaks = c(1, 5, 100, 1000, 10000, 20000),"
"0","    labels = c('1', '5', '100', '1000', '10000', '20000+')) +"
"0","  scale_shape_manual(values=c(17,rep(16, 28))) +  "
"0","  theme_minimal() +"
"0","  theme(legend.position = 'bottom',"
"0","        legend.justification = ""center"") +"
"0","        guides( color = guide_none(),"
"0","          size = guide_legend(title = ""Counts"", "
"0","                        override.aes = list(shape = c(17,rep(16,5))),"
"0","                        ncol = 6),  "
"0","          shape = guide_none()) +"
"0","  coord_flip()"
