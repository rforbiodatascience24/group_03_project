"0","data |>"
"0","  filter(nr_encounters == 2) |>"
"0","  select(patient_nbr, number_diagnoses,encounter_id) |>"
"0","  group_by(patient_nbr) |>"
"0","  arrange(encounter_id, .by_group = TRUE) |>"
"0","  mutate(visit_num = row_number()) |>"
"0","  ungroup() |>"
"0","  select(-encounter_id) |>"
"0","  pivot_wider("
"0","    names_from = visit_num,                "
"0","    values_from = number_diagnoses,        "
"0","    names_prefix = ""visit_"",          "
"0","    values_fill = list(number_diagnoses = NA)) |>"
"0","  pivot_longer(cols = -patient_nbr,"
"0","               names_to = 'visit') |>"
"0","  ggplot(aes(x=value,fill=visit)) +"
"0","  geom_boxplot() +"
"0","  labs(title = str_c('Amount of diagnoses for people with 2 visits (',"
"0","                      data |>"
"0","                       filter(nr_encounters == 2) |>"
"0","                       pull(patient_nbr) |>"
"0","                       unique() |>"
"0","                       length(),"
"0","                     ' people)'),"
"0","       x ='Number of diagnoses',"
"0","       fill = 'Visit number') +"
"0","  scale_fill_manual("
"0","    values = c(""visit_1"" = ""lightblue3"", ""visit_2"" = ""seagreen3""), "
"0","    labels = c(""1"", ""2"") "
"0","  )"
