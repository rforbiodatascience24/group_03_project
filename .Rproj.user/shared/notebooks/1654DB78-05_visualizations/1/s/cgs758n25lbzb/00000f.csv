"0","top_8_discharge_dispositions <- data |>"
"0","  group_by(discharge_disposition)|> "
"0","  summarize(n = n()) |> "
"0","  arrange(desc(n)) |> "
"0","  head(8) |> "
"0","  select(discharge_disposition) |> "
"0","  pull()"
"0",""
"0","data |> "
"0","  select(discharge_disposition, age) |> "
"0","  filter(discharge_disposition %in% top_8_discharge_dispositions) |> "
"0","  group_by(discharge_disposition, age) |> "
"0","  summarize(n = n(),.groups = 'keep') |> "
"0","  drop_na(discharge_disposition) |>"
"0","  ggplot("
"0","    mapping = aes(x = discharge_disposition,"
"0","                  y = n,"
"0","                  fill = age)"
"0","  ) +"
"0","  geom_col(position = ""dodge"") +"
"0","  scale_x_discrete(labels = function(x) str_wrap(x, width = 45)) +"
"0","  labs("
"0","    x = ""Discharge disposition"","
"0","    y = ""Count"","
"0","    fill = ""Age group"","
"0","    title = ""Discharge disposition for all age groups for all admission types"""
"0","  ) +"
"0","    theme_minimal() +"
"0","    theme("
"0","      axis.text.x = element_text(angle = 60, hjust =1)"
"0","    )"
