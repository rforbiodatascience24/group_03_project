"0","data |>"
"0","  mutate(race = ifelse(is.na(race),'Other',race)) |>"
"0","  mutate(race = ifelse(race == 'Other', 'Other/Unspecified', race)) |>"
"0","  group_by(age, "
"0","           gender, "
"0","           race) |> "
"0","  summarize(average_diagnoses = mean(number_diagnoses), .groups = ""drop"") |> "
"0","  ggplot(mapping = aes(x = age,"
"0","                y = average_diagnoses,"
"0","                fill = gender)) +"
"0","  geom_col(position = ""dodge"", "
"0","           alpha = 1.0) +"
"0","  facet_wrap(~ race) +"
"0","  labs("
"0","    x = ""Age Group"","
"0","    y = ""Average number of diagnoses"","
"0","    fill = ""Gender"","
"0","    title = "
"0","      ""Average number of diagnoses for all age groups and genders "
"0","        \n facet wrapped for race"") +"
"0","    scale_fill_manual(values=c('hotpink',"
"0","                             'cornflowerblue',"
"0","                             'grey35')) +"
"0","    theme_minimal() +"
"0","    theme(axis.text.x = element_text(angle = 60, hjust =1),"
"0","          legend.position = 'inside',"
"0","          legend.position.inside = c(0.85,0.15))"
"0",""
